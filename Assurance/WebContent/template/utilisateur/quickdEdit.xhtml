<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui" >

    <ui:composition>
        <div class="row">
            <div class="col-md-12 col-lg-12 col-sm-12">
                <p:outputPanel id="quickEditPanel" style="text-align:center;" class="panel">
                    <h:form id="quickEditForm" class="form-horizontal">
                        <p:growl id="msgs" globalOnly="true" showDetail="false"  life="3000"/>
                        <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12">
                            <div class="form-group" >
                                <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12">
                                    <p:outputLabel class="pull-left police_label" for="typeStructure" value="Type Structure"/>   
                                </div>
                                <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12">
                                    <p:selectOneRadio class=" " required="true"  id="typeStructure" value="#{gestionUtilisateurBean.choixTypeStructure}" requiredMessage="Veuillez choisir la structure">
                                        <f:selectItem itemLabel="#{msg['titre.compagnie']}" itemValue="compagnie" class="col-md-12 col-xs-12 col-sm-12" />
                                        <f:selectItem itemLabel="#{msg['titre.courtier']}" itemValue="courtier" class="col-md-12 col-xs-12 col-sm-12" />
                                        <f:selectItem itemLabel="#{msg['titre.pdv']}" itemValue="pointVente" class="col-md-12 col-xs-12 col-sm-12" />
                                        <f:selectItem itemLabel="#{msg['titre.pdr']}" itemValue="pointRetrait" class="col-md-12 col-xs-12 col-sm-12" />
                                        <f:selectItem itemLabel="NCP tech" itemValue="ncp" class="col-md-12 col-xs-12 col-sm-12" />
                                        <p:ajax listener="#{gestionUtilisateurBean.loadUserPermissionAndUserByTypeStructure()}" update="data,menu"/>
                                    </p:selectOneRadio> 
                                </div>
                                <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
                                    <p:selectCheckboxMenu class="col-lg-2 col-md-12 col-sm-12 col-xs-12 pull-left" id="menu" label="Permissions" converter="omnifaces.SelectItemsConverter" value="#{gestionUtilisateurBean.listOfPermissionSelected}"
                                                          filter="true" filterMatchMode="startsWith" style="width: 450px" required="true"  panelStyle="width:400px">
                                        <f:selectItems  value="#{gestionUtilisateurBean.listOfPermissions}" var="permi" itemLabel="#{permi.libelle}" itemValue="#{permi}"/>
                                    </p:selectCheckboxMenu>
                                </div>
                            </div>
                            <div class="form-group" >
                                <div class="col-lg-12  col-md-12 col-xs-12 col-sm-12">
                                    <div class="col-lg-2 col-md-12 pull-right col-xs-12 col-sm-12">
                                        <p:commandButton id="edit" action="#{gestionUtilisateurBean.updateSelection()}" update="@form" value="Modifier" onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" class="btn-success success form-control" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 col-xs-12 col-sm-12 col-md-12">
                            <div class="form-group table-responsive">
                                <p:dataTable sortOrder="descending" class="table table-bordered" var="utilisateur"  rows="50" rowKey="#{utilisateur.idUtilisateur}" 
                                             selection="#{gestionUtilisateurBean.usersSelectedForUpdate}" value="#{gestionUtilisateurBean.userListForQuickUpdate}" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             paginator="true" paginatorPosition="bottom" id="data" emptyMessage="#{msg['tableau.vide']}"
                                           rowsPerPageTemplate="50,100,150,200,500,1000"  >

                                    <p:column headerText="Nom" filterBy="#{utilisateur.nom}">
                                        <h:outputText value="#{utilisateur.nom}" />
                                    </p:column>
                                    <p:column headerText="PrÃ©nom" filterBy="#{utilisateur.prenom}">
                                        <h:outputText value="#{utilisateur.prenom}" />
                                    </p:column>
                                    <p:column headerText="Login" filterBy="#{utilisateur.login}">
                                        <h:outputText value="#{utilisateur.login}" />
                                    </p:column>
                                    <p:column headerText="#{msg['titre.profil']}" filterBy="#{utilisateur.profil.code}">
                                        <h:outputText value="#{utilisateur.profil.code}" />
                                    </p:column>
                                    <p:column headerText="Structure" filterBy="#{utilisateur.compagnie.designation}#{utilisateur.courtier.designation}#{utilisateur.pointsVente.designation}#{utilisateur.pointRetrait.libelle}#{utilisateur.societe.designation}">
                                        <h:outputText value="#{utilisateur.compagnie.designation}#{utilisateur.courtier.designation}#{utilisateur.pointsVente.designation}#{utilisateur.pointRetrait.libelle}#{utilisateur.societe.designation}" />
                                    </p:column>
                                    <p:column headerText="Selection" selectionMode="multiple" width="8%" style="text-align: center;" />
                                </p:dataTable>
                            </div>
                        </div>
                    </h:form>
                </p:outputPanel>
            </div>
        </div>
    </ui:composition> 
</html>

