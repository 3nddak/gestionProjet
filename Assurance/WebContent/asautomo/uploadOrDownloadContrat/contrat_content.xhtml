<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">


    <ui:composition>
        <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
            <fieldset>
                <legend class="text-center text-uppercase"> <p:outputLabel value="#{msg['telecharger.contrat']}"></p:outputLabel></legend>
            </fieldset>
            <h:form id="vf" >

                <p:dataTable class="table_label table table-responsive" var="facture" id="display" editable="true" editMode="cell"  rows="10" value="#{chargerContrats.listDestContrats}"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             paginator="true" paginatorPosition="bottom" style="margin-bottom:20px" scrollWidth="50%" scrollHeight="150"  
                             rowsPerPageTemplate="2,3,4,5,6,7"  emptyMessage="#{msg['tableau.vide']}" 
                             >                      

                    <p:column headerText="Numero Police">
                        <p:outputLabel value="#{facture.objetVoiture.numeroPolice}"/>
                    </p:column>
                    <p:column headerText="#{msg['titre.compagnie']}">
                        <p:outputLabel value="#{facture.compagnie.abbreviation}"/>
                    </p:column>
                    <p:column headerText="#{msg['client.nom']}">
                        <p:outputLabel value="#{facture.objetVoiture.client.nom}"/>
                    </p:column>
                    <p:column headerText="#{msg['client.prenom']}" >
                        <p:outputLabel value="#{facture.objetVoiture.client.prenom}"/>
                    </p:column>

                    <p:column headerText="#{msg['vehicule.marque']}" >
                        <p:outputLabel value="#{facture.objetVoiture.marque}"/>
                    </p:column>
                    <p:column headerText="#{msg['vehicule.type']}">
                        <p:outputLabel value="#{facture.objetVoiture.type}"/>
                    </p:column>
                    <p:column headerText="#{msg['vehicule.energie']}" >
                        <p:outputLabel value="#{facture.objetVoiture.energie.libelleEn}"/>
                    </p:column>
                    <p:column headerText="#{msg['vehicule.numerochassis']}" >
                        <p:outputLabel value="#{facture.objetVoiture.numChassis}"/>
                    </p:column>
                    <p:column headerText="#{msg['vehicule.genre']}">
                        <p:outputLabel value="#{facture.objetVoiture.genre}"/>
                    </p:column>
                    <p:column headerText="#{msg['vehicule.categorie']}" >
                        <p:outputLabel value="#{facture.objetVoiture.categorie.libelle}"/>
                    </p:column>
                    <p:column headerText="Action">

                        <p:commandLink   title="#{msg['titre.rcu']}" class=" btn btn-xs btn-imprimer fa fa-print" ajax="false" target="/rapport"   action="#{allMessageBean.doGetFor2ndRecu()}" >
                            <f:setPropertyActionListener target="#{allMessageBean.factureSelect}" value="#{facture}" />
                        </p:commandLink>
                        <p:commandLink rendered="false"  title="#{msg['charger.contrat']}" oncomplete="PF('contrat').show()" class="btn btn-sm btn-primary glyphicon glyphicon-upload" >
                            <f:setPropertyActionListener target="#{chargerContrats.factureSelect}" value="#{facture}" />
                        </p:commandLink>
                        <p:commandLink rendered="#{facture.contratIsUpload}" title="#{msg['telecharger.contrat']}"  class="btn btn-sm btn-imprimer   glyphicon glyphicon-download-alt" target="/" action="#{chargerContrats.doGetA()}"  ajax="false" >
                            <f:setPropertyActionListener target="#{chargerContrats.factureSelect}" value="#{facture}" />
                        </p:commandLink>
                    </p:column>

                </p:dataTable>


            </h:form>
            <p:dialog widgetVar="contrat" modal="true" draggable="false" closable="true" resizable="true" showHeader="false" >
                <h:form>
                    <p:fileUpload update="vf" allowTypes="/(\.|\/)(gif|jpe?g|png|bmp|pdf)$/"  fileUploadListener="#{chargerContrats.handleFileUpload}"  multiple="false"  >

                    </p:fileUpload>
                    <p:commandButton value="#{msg['btn.fermer']}"   oncomplete="PF('contrat').hide()"   />
                </h:form>
            </p:dialog>

            <p:confirmDialog  global="true" showEffect="fade" hideEffect="fade">
                <h:form>
                    <p:commandButton value="#{msg['supprimer.oui']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" actionListener="#{factureCourtierBean.comptabilite()}" />
                    <p:commandButton value="#{msg['supprimer.non']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                </h:form>
            </p:confirmDialog>



        </div>
    </ui:composition>
</html>
