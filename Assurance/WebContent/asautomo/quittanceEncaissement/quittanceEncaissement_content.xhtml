<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"  

      >


    <ui:composition>

        <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">


            <div class="panel">
                <h:form  id="formliste">
                    <p:growl id="msgs"  globalOnly="true"  severity="info,warn"/>   
                    <div class="panel-heading"> 

                        <fieldset>
                            <legend class="police_label text-center"><p:outputLabel value="#{msg['page.menu.quittanceEncaissement']}"></p:outputLabel></legend>

                        </fieldset>

                    </div>
                    <br/> 
                    <p:panel id="t6" header="#{msg['titre.recherche']}" toggleable="true" collapsed="true" style="margin-bottom:20px">
                        <div class="form-group">
                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <h:outputLabel for="pays"  value="#{msg['titre.pays']}" class="pull-left text-left"/>                              
                                <h:selectOneMenu id="pays"   class="form-control"  converter="entityConverter" value="#{quittanceBean.paysSelected}" >                                          
                                    <f:selectItem itemLabel="#{msg['titre.tous']}"  />
                                    <f:selectItems var="pays" value="#{quittanceBean.listerParametreByUserService.listpays}" itemLabel="#{pays.designationPays}" itemValue="#{pays}" />            
                                    <p:ajax  listener="#{quittanceBean.listerParametreByUserService.trierPrametresByPays()}" update="compagnie,courtier,pv,gt" />
                                </h:selectOneMenu>

                            </div>
                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <h:outputLabel for="compagnie"  value="#{msg['titre.compagnie']}" class="pull-left text-left"/>                              
                                <h:selectOneMenu id="compagnie" value="#{quittanceBean.compagnieSelected}"  converter="entityConverter"  class="form-control" >                                          
                                    <f:selectItem itemLabel="#{msg['titre.tous']}"  />
                                    <f:selectItems value="#{quittanceBean.listerParametreByUserService.listCompagnie}" var="compagnie" itemLabel="#{compagnie.abbreviation}" itemValue="#{compagnie}" />            
                                </h:selectOneMenu>


                            </div>
                        </div>
                        <p:spacer/>
                        <div class="form-group">
                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <h:outputLabel for="courtier"  value="#{msg['titre.courtier']}" class="pull-left text-left"/>                               
                                <h:selectOneMenu id="courtier"  converter="entityConverter" value="#{quittanceBean.courtierSelected}" class="form-control" >                                          
                                    <f:selectItem itemLabel="#{msg['titre.tous']}"  />
                                    <f:selectItems var="courtier" value="#{quittanceBean.listerParametreByUserService.listCourtier}" itemLabel="#{courtier.abbreviation}" itemValue="#{courtier}" />            
                                </h:selectOneMenu>


                            </div>
                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <h:outputLabel for="pv"  value="#{msg['titre.pdv']}" class="pull-left text-left"/>                          
                                <h:selectOneMenu id="pv"  value="#{quittanceBean.pvSelected}"  converter="entityConverter" class="form-control" >                                          
                                    <f:selectItem itemLabel="#{msg['titre.tous']}"  />
                                    <f:selectItems var="pv" value="#{quittanceBean.listerParametreByUserService.listPointsVente}" itemLabel="#{pv.designation}" itemValue="#{pv}" />            
                                </h:selectOneMenu>


                            </div>
                        </div>
                        <p:spacer/>
                        <div class="form-group">
                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <h:outputLabel for="gt"  value="#{msg['titre.guichet']}" class="pull-left text-left"/>                            
                                <h:selectOneMenu id="gt"  value="#{quittanceBean.guichetSelected}"  converter="entityConverter" class="form-control" >                                          
                                    <f:selectItem itemLabel="#{msg['titre.tous']}"  />
                                    <f:selectItems var="guichet" value="#{quittanceBean.listerParametreByUserService.listGuichet}" itemLabel="#{guichet.designation}" itemValue="#{guichet}" />            
                                </h:selectOneMenu>

                            </div>

                        </div>

                        <div class="form-group">
                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">

                                    <p:outputLabel for="mask" value="#{msg['souscription.datedebut']}:" />
                                    <p:calendar id="mask"  pattern="dd-MM-yyyy" mask="true" value="#{quittanceBean.dateDebut}" >
                                    </p:calendar>
                                </div>

                                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                    <p:outputLabel for="mask" value="#{msg['souscription.datefin']}:" />
                                    <p:calendar id="mask2"   pattern="dd-MM-yyyy" mask="true" value="#{quittanceBean.dateFin}">
                                    </p:calendar>
                                </div>
                            </div>
                        </div>
                        <p:spacer/>
                        <div class="form-group">
                            <p:commandButton value="#{msg['btn.rechercher']}" onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" action="#{quittanceBean.rechercheAvance()}"  update="facture" />
                        </div>
                    </p:panel>
                    <p:panel  header="#{msg['liste.quittance']} " toggleable="true" collapsed="false" style="margin-bottom:20px">
                        <div class="row">

                            <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12">
                                  <div class="col-md-4 col-lg-3 col-sm-4 col-xs-4">
                                <h:outputText value="#{msg['Operations.Jour']} :  " style="color: black" />
                                <p:selectBooleanCheckbox id="sc1"  value="#{quittanceBean.operationsJours}" class="" >
                                    <p:ajax listener="#{quittanceBean.imprimerOperationsDuJour()}" update="sc1,sc2,sc3,sc4,facture" />
                                </p:selectBooleanCheckbox>
                            </div>
                              <div class="col-md-4 col-lg-3 col-sm-4 col-xs-4">
                                <h:outputText value="#{msg['Operations.semaine']} :  " style="color: black" />
                                <p:selectBooleanCheckbox id="sc2"  value="#{quittanceBean.operationsSemaine}" class="" >
                                    <p:ajax listener="#{quittanceBean.imprimerOperationsDeLaSemaine()}" update="sc1,sc2,sc3,sc4,facture" />
                                </p:selectBooleanCheckbox>
                            </div>
                              <div class="col-md-4 col-lg-3 col-sm-4 col-xs-4">
                                <h:outputText value="#{msg['Operations.mois']} :  " style="color: black" />
                                <p:selectBooleanCheckbox id="sc3"  value="#{quittanceBean.operationsMois}" class="" >
                                    <p:ajax listener="#{quittanceBean.imprimerOperationsDuMois()}" update="sc1,sc2,sc3,sc4,facture" />
                                </p:selectBooleanCheckbox>
                            </div>
                             <div class="col-md-4 col-lg-3 col-sm-4 col-xs-4">
                                <h:outputText value="#{msg['Operations.annee']} :  " style="color: black" />
                                <p:selectBooleanCheckbox id="sc4"  value="#{quittanceBean.operationsAnnee}" class="" >
                                    <p:ajax listener="#{quittanceBean.imprimerOperationsdeLannee()}" update="sc1,sc2,sc3,sc4,facture" />
                                </p:selectBooleanCheckbox>
                            </div>
                                  </div>

                        </div>
                        <div class="table-responsive">
                            <p:commandLink title="#{msg['btn.imprimer']}" value="#{msg['btn.imprimer']}"  action="#{quittanceBean.doGetPrintRecuBonAssurance()}" target="/"  class="btn btn-imprimer btn-xs  glyphicon glyphicon-print"  ajax="false" ></p:commandLink>
                            <p:dataTable id="facture" editable="true" editMode="cell"
                                         resizableColumns="true"
                                         class="table" 
                                         paginator="true" rows="4" emptyMessage="#{msg['tableau.vide']}"  paginatorPosition="bottom" value="#{quittanceBean.listFacture}" var="facture"    style="padding:0px;margin: 0px; ">
                                <p:column headerText="#{msg['tableau.numeropolice']}"  class="col-md-2 col-lg-1"  filterBy="#{facture.objetVoiture.numeroPolice}"  >
                                    <h:outputText rendered="#{facture.affichePolice}" value="#{facture.objetVoiture.numeroPolice}" />
                                </p:column>
                                <p:column headerText="#{msg['souscription.datedebut']}"    >
                                    <h:outputText value="#{facture.formatDate(facture.dateDebut)}" />
                                </p:column>
                                <p:column headerText="#{msg['souscription.datefin']}"    >
                                    <h:outputText value="#{facture.formatDate(facture.dateFin)}" />
                                </p:column>
                                <p:column class="col-md-2 col-lg-2"  headerText="#{msg['titre.Codetransactioncourtier']} " filterBy="#{facture.codeFactureCourtier}">
                                    <h:outputText value="#{facture.codeFactureCourtier}" rendered="#{facture.afficheCode}"/>
                                </p:column>

                                <p:column headerText="#{msg['titre.compagnie']}"   filterBy="#{facture.compagnie.abbreviation}">
                                    <h:outputText value="#{facture.compagnie.abbreviation}" />
                                </p:column>
                                <p:column headerText="#{msg['titre.courtier']}"  filterBy="#{facture.courtier.abbreviation}">
                                    <h:outputText value="#{facture.courtier.abbreviation}" />
                                </p:column>

                                <p:column  headerText="#{msg['client.nom']}"  filterBy="#{facture.objetVoiture.client.nom}"  >
                                    <h:outputText value="#{facture.objetVoiture.client.nom}" />
                                </p:column>

                                <p:column  headerText="#{msg['vehicule.categorie']}"  filterBy="#{facture.objetVoiture.categorie.libelle}" > 
                                    <h:outputText value="#{facture.objetVoiture.categorie.libelle}" />
                                </p:column>

                                <p:column filterBy="#{facture.primeTtc}" headerText="#{msg['tableau.primettc']}"  >
                                    <p:outputLabel value="#{facture.arrondireFormat2(facture.primeTtc)}" />
                                </p:column>
                                <p:column  headerText="Action"  >
                                    <p:commandLink   title="I#{msg['btn.imprimer']}" class=" btn btn-xs btn-imprimer fa fa-print" ajax="false" target="/rapport"    action="#{quittanceBean.doGetPrinToneHitorique()}" >

                                        <f:setPropertyActionListener target="#{quittanceBean.selectedFacture1}" value="#{facture}"/>
                                    </p:commandLink>
                                </p:column>

                            </p:dataTable>
                        </div>
                        
                            
                    </p:panel>
                    <p:separator style="background-color: #204d74" />
                </h:form>

            </div>


        </div>



        <p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
            <h:graphicImage library="images" name="ajax-loader.gif" />
        </p:dialog>



    </ui:composition> 

</html>

